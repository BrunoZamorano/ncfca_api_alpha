status: pending

Título curto
- Meu Clube: GET my-club e PATCH update

Objetivo
- Implementar testes E2E para consultar e atualizar informações do meu clube, cobrindo sucesso e cenários de autorização/validação.

Arquivos e caminhos (criar/editar)
- Criar: `test/club-management/get-my-club.e2e-spec.ts`
- Criar: `test/club-management/update-club-info.e2e-spec.ts`

Contratos e estruturas (DTOs/entities/interfaces e campos)
- GET retorna `ClubDto` (`src/domain/dtos/club.dto.ts`): `id`, `name`, `maxMembers?`, `address{street,number,district,city,state,zipCode,complement?}`, `principalId`, `createdAt`, `corum`.
- PATCH recebe `UpdateClubDto` (`src/infraestructure/dtos/update-club.dto.ts`) — validar `name?`, `maxMembers? (>=2)`, `address?` com shape válido.

Regras de negócio e validações
- Apenas o usuário com role `DONO_DE_CLUBE` e que seja `principalId` do clube pode consultar/atualizar.
- GET `my-club` deve retornar 200 com dados do clube do dono autenticado; 404 se não existir.
- PATCH `/club-management` deve retornar 204 em sucesso; 422/400 para payload inválido; 403 para não-dono; 401 sem token.

Passo a passo
1. Setup comum: inicializar app (ver task 01), criar usuário `DONO_DE_CLUBE` e criar manualmente um `club` no Prisma com `principal_id = user.userId`.
2. `get-my-club.e2e-spec.ts`:
   - Caso feliz: autenticar como dono e `GET /club-management/my-club` ⇒ 200 e body com `id === club.id`, `name`, `address`, `principalId`.
   - Sem clube: para outro usuário dono sem clube, esperar 404.
   - Sem token: 401.
3. `update-club-info.e2e-spec.ts`:
   - Caso feliz: `PATCH /club-management` autenticado como dono com body contendo novo `name` e/ou `address` ⇒ 204; assert via Prisma que o `club` foi atualizado.
   - Validação: enviar `maxMembers: 1` ⇒ 400/422; enviar `address` com campo extra ⇒ 400 (whitelist/forbidNonWhitelisted).
   - Autorização: usuário que não é o `principal_id` ⇒ 403.
   - Sem token: 401.
4. Cleanup cirúrgico: remover apenas dados relacionados aos `userIds` criados na suíte via `surgicalCleanup`.

Critérios de aceite (checáveis)
- Todos os casos acima com asserts explícitos em status e conteúdo.
- Busca/verificação pós-PATCH realizada via Prisma.
- Descrições iniciando com “Deve/Não deve” e suíte nomeada com `(E2E)`.

Testes mínimos (âncoras de teste)
- `it('Deve retornar os dados do meu clube', ...)`.
- `it('Não deve atualizar clube de outro usuário', ...)`.
- `it('Não deve aceitar maxMembers menor que 2', ...)`.

Notas de versão/refs do Context7 (curtas)
- Regras: `AI/rules/test.standards.yml` (um comportamento por teste; foco no negócio, não em HTTP nas descrições).
